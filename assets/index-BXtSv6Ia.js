import{O as U,d as W,r as y,A as X,v as _,q as j,b9 as D,U as F,b as k,X as G,ab as f,a1 as J}from"./index-Al1ESLyH.js";const[K,H]=U("text-ellipsis"),L={rows:G(1),dots:f("..."),content:f(""),expandText:f(""),collapseText:f(""),position:f("end")};var Q=W({name:K,props:L,emits:["clickAction"],setup(e,{emit:S,slots:N}){const T=y(""),r=y(!1),p=y(!1),h=y(),w=X(()=>r.value?e.collapseText:e.expandText),b=i=>{if(!i)return 0;const v=i.match(/^\d*(\.\d*)?/);return v?Number(v[0]):0},g=()=>{const i=()=>{if(!h.value)return;const s=window.getComputedStyle(h.value),t=document.createElement("div");return Array.prototype.slice.apply(s).forEach(d=>{t.style.setProperty(d,s.getPropertyValue(d))}),t.style.position="fixed",t.style.zIndex="-9999",t.style.top="-9999px",t.style.height="auto",t.style.minHeight="auto",t.style.maxHeight="auto",t.innerText=e.content,document.body.appendChild(t),t},v=(s,t)=>{const{content:a,position:d,dots:x}=e,u=a.length,O=()=>{const n=(o,l)=>{if(l-o<=1)return d==="end"?a.slice(0,o)+x:x+a.slice(l,u);const c=Math.round((o+l)/2);return d==="end"?s.innerText=a.slice(0,c)+x+w.value:s.innerText=x+a.slice(c,u)+w.value,s.offsetHeight>t?d==="end"?n(o,c):n(c,l):d==="end"?n(c,l):n(o,c)};s.innerText=n(0,u)},E=(n,o)=>{if(n[1]-n[0]<=1&&o[1]-o[0]<=1)return a.slice(0,n[0])+x+a.slice(o[1],u);const l=Math.floor((n[0]+n[1])/2),c=Math.ceil((o[0]+o[1])/2);return s.innerText=e.content.slice(0,l)+e.dots+e.content.slice(c,u)+e.expandText,s.offsetHeight>=t?E([n[0],l],[c,o[1]]):E([l,n[1]],[o[0],c])},M=0+u>>1;return e.position==="middle"?s.innerText=E([0,M],[M,u]):O(),s.innerText},m=i();if(!m)return;const{paddingBottom:q,paddingTop:z,lineHeight:B}=m.style,C=Math.ceil((Number(e.rows)+.5)*b(B)+b(z)+b(q));C<m.offsetHeight?(p.value=!0,T.value=v(m,C)):(p.value=!1,T.value=e.content),document.body.removeChild(m)},A=(i=!r.value)=>{r.value=i},I=i=>{A(),S("clickAction",i)},V=()=>{const i=N.action?N.action({expanded:r.value}):w.value;return k("span",{class:H("action"),onClick:I},[i])};return _(g),j([D,()=>[e.content,e.rows,e.position]],g),F({toggle:A}),()=>k("div",{ref:h,class:H()},[r.value?e.content:T.value,p.value?V():null])}});const Y=J(Q);export{Y as T};
