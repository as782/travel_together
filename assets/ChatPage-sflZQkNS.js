import{r as R,q as ce,O as Ne,d as re,v as ke,aK as Be,x as Ve,aL as qe,b as O,ai as ze,af as Ue,ag as $e,aM as We,D as Z,ab as G,aN as He,a9 as Fe,ac as J,aa as Xe,t as Ye,ao as he,aO as Ge,a7 as Je,I as Pe,aP as Ke,a1 as Qe,A as $,o as M,c as T,a as C,E as X,K as se,a3 as Re,i as Ze,aQ as et,aR as tt,C as ue,u as Ce,G as at,s as ie,B as ge,w as F,V as rt,ar as nt,aA as ot,N as st,a2 as it,f as lt,M as we,g as ct}from"./index-Al1ESLyH.js";import{I as ut}from"./index-o3mCI9mj.js";import{u as ft}from"./message-BTh5o252.js";import{a as pt,R as ye,M as dt,s as vt}from"./index-BXhODArz.js";import{B as mt}from"./index-dW7UAVpM.js";const ht=(t,e)=>{const a=R(t());return ce(t,r=>{r!==a.value&&(a.value=r)}),ce(a,r=>{r!==t()&&e(r)}),a};function j(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function de(t){var e=j(t).Element;return t instanceof e||t instanceof Element}function I(t){var e=j(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function Me(t){if(typeof ShadowRoot>"u")return!1;var e=j(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}var H=Math.round;function fe(){var t=navigator.userAgentData;return t!=null&&t.brands?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function gt(){return!/^((?!chrome|android).)*safari/i.test(fe())}function ee(t,e,a){e===void 0&&(e=!1),a===void 0&&(a=!1);var r=t.getBoundingClientRect(),n=1,o=1;e&&I(t)&&(n=t.offsetWidth>0&&H(r.width)/t.offsetWidth||1,o=t.offsetHeight>0&&H(r.height)/t.offsetHeight||1);var l=de(t)?j(t):window,c=l.visualViewport,s=!gt()&&a,u=(r.left+(s&&c?c.offsetLeft:0))/n,i=(r.top+(s&&c?c.offsetTop:0))/o,m=r.width/n,E=r.height/o;return{width:m,height:E,top:i,right:u+m,bottom:i+E,left:u,x:u,y:i}}function Ie(t){var e=j(t),a=e.pageXOffset,r=e.pageYOffset;return{scrollLeft:a,scrollTop:r}}function wt(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function yt(t){return t===j(t)||!I(t)?Ie(t):wt(t)}function L(t){return t?(t.nodeName||"").toLowerCase():null}function ne(t){return((de(t)?t.ownerDocument:t.document)||window.document).documentElement}function bt(t){return ee(ne(t)).left+Ie(t).scrollLeft}function N(t){return j(t).getComputedStyle(t)}function ve(t){var e=N(t),a=e.overflow,r=e.overflowX,n=e.overflowY;return/auto|scroll|overlay|hidden/.test(a+n+r)}function xt(t){var e=t.getBoundingClientRect(),a=H(e.width)/t.offsetWidth||1,r=H(e.height)/t.offsetHeight||1;return a!==1||r!==1}function Ot(t,e,a){a===void 0&&(a=!1);var r=I(e),n=I(e)&&xt(e),o=ne(e),l=ee(t,n,a),c={scrollLeft:0,scrollTop:0},s={x:0,y:0};return(r||!r&&!a)&&((L(e)!=="body"||ve(o))&&(c=yt(e)),I(e)?(s=ee(e,!0),s.x+=e.clientLeft,s.y+=e.clientTop):o&&(s.x=bt(o))),{x:l.left+c.scrollLeft-s.x,y:l.top+c.scrollTop-s.y,width:l.width,height:l.height}}function _t(t){var e=ee(t),a=t.offsetWidth,r=t.offsetHeight;return Math.abs(e.width-a)<=1&&(a=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:t.offsetLeft,y:t.offsetTop,width:a,height:r}}function me(t){return L(t)==="html"?t:t.assignedSlot||t.parentNode||(Me(t)?t.host:null)||ne(t)}function je(t){return["html","body","#document"].indexOf(L(t))>=0?t.ownerDocument.body:I(t)&&ve(t)?t:je(me(t))}function Q(t,e){var a;e===void 0&&(e=[]);var r=je(t),n=r===((a=t.ownerDocument)==null?void 0:a.body),o=j(r),l=n?[o].concat(o.visualViewport||[],ve(r)?r:[]):r,c=e.concat(l);return n?c:c.concat(Q(me(l)))}function St(t){return["table","td","th"].indexOf(L(t))>=0}function be(t){return!I(t)||N(t).position==="fixed"?null:t.offsetParent}function Et(t){var e=/firefox/i.test(fe()),a=/Trident/i.test(fe());if(a&&I(t)){var r=N(t);if(r.position==="fixed")return null}var n=me(t);for(Me(n)&&(n=n.host);I(n)&&["html","body"].indexOf(L(n))<0;){var o=N(n);if(o.transform!=="none"||o.perspective!=="none"||o.contain==="paint"||["transform","perspective"].indexOf(o.willChange)!==-1||e&&o.willChange==="filter"||e&&o.filter&&o.filter!=="none")return n;n=n.parentNode}return null}function De(t){for(var e=j(t),a=be(t);a&&St(a)&&N(a).position==="static";)a=be(a);return a&&(L(a)==="html"||L(a)==="body"&&N(a).position==="static")?e:a||Et(t)||e}var W="top",te="bottom",Y="right",U="left",Ae="auto",kt=[W,te,Y,U],Te="start",ae="end",Pt=[].concat(kt,[Ae]).reduce(function(t,e){return t.concat([e,e+"-"+Te,e+"-"+ae])},[]),Rt="beforeRead",Ct="read",Mt="afterRead",It="beforeMain",jt="main",Dt="afterMain",At="beforeWrite",Tt="write",Lt="afterWrite",pe=[Rt,Ct,Mt,It,jt,Dt,At,Tt,Lt];function Nt(t){var e=new Map,a=new Set,r=[];t.forEach(function(o){e.set(o.name,o)});function n(o){a.add(o.name);var l=[].concat(o.requires||[],o.requiresIfExists||[]);l.forEach(function(c){if(!a.has(c)){var s=e.get(c);s&&n(s)}}),r.push(o)}return t.forEach(function(o){a.has(o.name)||n(o)}),r}function Bt(t){var e=Nt(t);return pe.reduce(function(a,r){return a.concat(e.filter(function(n){return n.phase===r}))},[])}function Vt(t){var e;return function(){return e||(e=new Promise(function(a){Promise.resolve().then(function(){e=void 0,a(t())})})),e}}function V(t){for(var e=arguments.length,a=new Array(e>1?e-1:0),r=1;r<e;r++)a[r-1]=arguments[r];return[].concat(a).reduce(function(n,o){return n.replace(/%s/,o)},t)}var q='Popper: modifier "%s" provided an invalid %s property, expected %s but got %s',qt='Popper: modifier "%s" requires "%s", but "%s" modifier is not available',xe=["name","enabled","phase","fn","effect","requires","options"];function zt(t){t.forEach(function(e){[].concat(Object.keys(e),xe).filter(function(a,r,n){return n.indexOf(a)===r}).forEach(function(a){switch(a){case"name":typeof e.name!="string"&&console.error(V(q,String(e.name),'"name"','"string"','"'+String(e.name)+'"'));break;case"enabled":typeof e.enabled!="boolean"&&console.error(V(q,e.name,'"enabled"','"boolean"','"'+String(e.enabled)+'"'));break;case"phase":pe.indexOf(e.phase)<0&&console.error(V(q,e.name,'"phase"',"either "+pe.join(", "),'"'+String(e.phase)+'"'));break;case"fn":typeof e.fn!="function"&&console.error(V(q,e.name,'"fn"','"function"','"'+String(e.fn)+'"'));break;case"effect":e.effect!=null&&typeof e.effect!="function"&&console.error(V(q,e.name,'"effect"','"function"','"'+String(e.fn)+'"'));break;case"requires":e.requires!=null&&!Array.isArray(e.requires)&&console.error(V(q,e.name,'"requires"','"array"','"'+String(e.requires)+'"'));break;case"requiresIfExists":Array.isArray(e.requiresIfExists)||console.error(V(q,e.name,'"requiresIfExists"','"array"','"'+String(e.requiresIfExists)+'"'));break;case"options":case"data":break;default:console.error('PopperJS: an invalid property has been provided to the "'+e.name+'" modifier, valid properties are '+xe.map(function(r){return'"'+r+'"'}).join(", ")+'; but "'+a+'" was provided.')}e.requires&&e.requires.forEach(function(r){t.find(function(n){return n.name===r})==null&&console.error(V(qt,String(e.name),r,r))})})})}function Ut(t,e){var a=new Set;return t.filter(function(r){var n=e(r);if(!a.has(n))return a.add(n),!0})}function oe(t){return t.split("-")[0]}function $t(t){var e=t.reduce(function(a,r){var n=a[r.name];return a[r.name]=n?Object.assign({},n,r,{options:Object.assign({},n.options,r.options),data:Object.assign({},n.data,r.data)}):r,a},{});return Object.keys(e).map(function(a){return e[a]})}function Le(t){return t.split("-")[1]}function Wt(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function Ht(t){var e=t.reference,a=t.element,r=t.placement,n=r?oe(r):null,o=r?Le(r):null,l=e.x+e.width/2-a.width/2,c=e.y+e.height/2-a.height/2,s;switch(n){case W:s={x:l,y:e.y-a.height};break;case te:s={x:l,y:e.y+e.height};break;case Y:s={x:e.x+e.width,y:c};break;case U:s={x:e.x-a.width,y:c};break;default:s={x:e.x,y:e.y}}var u=n?Wt(n):null;if(u!=null){var i=u==="y"?"height":"width";switch(o){case Te:s[u]=s[u]-(e[i]/2-a[i]/2);break;case ae:s[u]=s[u]+(e[i]/2-a[i]/2);break}}return s}var Oe="Popper: Invalid reference or popper argument provided. They must be either a DOM element or virtual element.",Ft="Popper: An infinite loop in the modifiers cycle has been detected! The cycle has been interrupted to prevent a browser crash.",_e={placement:"bottom",modifiers:[],strategy:"absolute"};function Se(){for(var t=arguments.length,e=new Array(t),a=0;a<t;a++)e[a]=arguments[a];return!e.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function Xt(t){t===void 0&&(t={});var e=t,a=e.defaultModifiers,r=a===void 0?[]:a,n=e.defaultOptions,o=n===void 0?_e:n;return function(c,s,u){u===void 0&&(u=o);var i={placement:"bottom",orderedModifiers:[],options:Object.assign({},_e,o),modifiersData:{},elements:{reference:c,popper:s},attributes:{},styles:{}},m=[],E=!1,v={state:i,setOptions:function(k){var p=typeof k=="function"?k(i.options):k;b(),i.options=Object.assign({},o,i.options,p),i.scrollParents={reference:de(c)?Q(c):c.contextElement?Q(c.contextElement):[],popper:Q(s)};var w=Bt($t([].concat(r,i.options.modifiers)));i.orderedModifiers=w.filter(function(S){return S.enabled});{var x=Ut([].concat(w,i.options.modifiers),function(S){var B=S.name;return B});if(zt(x),oe(i.options.placement)===Ae){var y=i.orderedModifiers.find(function(S){var B=S.name;return B==="flip"});y||console.error(['Popper: "auto" placements require the "flip" modifier be',"present and enabled to work."].join(" "))}var f=N(s),d=f.marginTop,_=f.marginRight,P=f.marginBottom,A=f.marginLeft;[d,_,P,A].some(function(S){return parseFloat(S)})&&console.warn(['Popper: CSS "margin" styles cannot be used to apply padding',"between the popper and its reference element or boundary.","To replicate margin, use the `offset` modifier, as well as","the `padding` option in the `preventOverflow` and `flip`","modifiers."].join(" "))}return D(),v.update()},forceUpdate:function(){if(!E){var k=i.elements,p=k.reference,w=k.popper;if(!Se(p,w)){console.error(Oe);return}i.rects={reference:Ot(p,De(w),i.options.strategy==="fixed"),popper:_t(w)},i.reset=!1,i.placement=i.options.placement,i.orderedModifiers.forEach(function(S){return i.modifiersData[S.name]=Object.assign({},S.data)});for(var x=0,y=0;y<i.orderedModifiers.length;y++){if(x+=1,x>100){console.error(Ft);break}if(i.reset===!0){i.reset=!1,y=-1;continue}var f=i.orderedModifiers[y],d=f.fn,_=f.options,P=_===void 0?{}:_,A=f.name;typeof d=="function"&&(i=d({state:i,options:P,name:A,instance:v})||i)}}},update:Vt(function(){return new Promise(function(g){v.forceUpdate(),g(i)})}),destroy:function(){b(),E=!0}};if(!Se(c,s))return console.error(Oe),v;v.setOptions(u).then(function(g){!E&&u.onFirstUpdate&&u.onFirstUpdate(g)});function D(){i.orderedModifiers.forEach(function(g){var k=g.name,p=g.options,w=p===void 0?{}:p,x=g.effect;if(typeof x=="function"){var y=x({state:i,name:k,instance:v,options:w}),f=function(){};m.push(y||f)}})}function b(){m.forEach(function(g){return g()}),m=[]}return v}}var K={passive:!0};function Yt(t){var e=t.state,a=t.instance,r=t.options,n=r.scroll,o=n===void 0?!0:n,l=r.resize,c=l===void 0?!0:l,s=j(e.elements.popper),u=[].concat(e.scrollParents.reference,e.scrollParents.popper);return o&&u.forEach(function(i){i.addEventListener("scroll",a.update,K)}),c&&s.addEventListener("resize",a.update,K),function(){o&&u.forEach(function(i){i.removeEventListener("scroll",a.update,K)}),c&&s.removeEventListener("resize",a.update,K)}}var Gt={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:Yt,data:{}};function Jt(t){var e=t.state,a=t.name;e.modifiersData[a]=Ht({reference:e.rects.reference,element:e.rects.popper,strategy:"absolute",placement:e.placement})}var Kt={name:"popperOffsets",enabled:!0,phase:"read",fn:Jt,data:{}},Qt={top:"auto",right:"auto",bottom:"auto",left:"auto"};function Zt(t){var e=t.x,a=t.y,r=window,n=r.devicePixelRatio||1;return{x:H(e*n)/n||0,y:H(a*n)/n||0}}function Ee(t){var e,a=t.popper,r=t.popperRect,n=t.placement,o=t.variation,l=t.offsets,c=t.position,s=t.gpuAcceleration,u=t.adaptive,i=t.roundOffsets,m=t.isFixed,E=l.x,v=E===void 0?0:E,D=l.y,b=D===void 0?0:D,g=typeof i=="function"?i({x:v,y:b}):{x:v,y:b};v=g.x,b=g.y;var k=l.hasOwnProperty("x"),p=l.hasOwnProperty("y"),w=U,x=W,y=window;if(u){var f=De(a),d="clientHeight",_="clientWidth";if(f===j(a)&&(f=ne(a),N(f).position!=="static"&&c==="absolute"&&(d="scrollHeight",_="scrollWidth")),f=f,n===W||(n===U||n===Y)&&o===ae){x=te;var P=m&&f===y&&y.visualViewport?y.visualViewport.height:f[d];b-=P-r.height,b*=s?1:-1}if(n===U||(n===W||n===te)&&o===ae){w=Y;var A=m&&f===y&&y.visualViewport?y.visualViewport.width:f[_];v-=A-r.width,v*=s?1:-1}}var S=Object.assign({position:c},u&&Qt),B=i===!0?Zt({x:v,y:b}):{x:v,y:b};if(v=B.x,b=B.y,s){var h;return Object.assign({},S,(h={},h[x]=p?"0":"",h[w]=k?"0":"",h.transform=(y.devicePixelRatio||1)<=1?"translate("+v+"px, "+b+"px)":"translate3d("+v+"px, "+b+"px, 0)",h))}return Object.assign({},S,(e={},e[x]=p?b+"px":"",e[w]=k?v+"px":"",e.transform="",e))}function ea(t){var e=t.state,a=t.options,r=a.gpuAcceleration,n=r===void 0?!0:r,o=a.adaptive,l=o===void 0?!0:o,c=a.roundOffsets,s=c===void 0?!0:c;{var u=N(e.elements.popper).transitionProperty||"";l&&["transform","top","right","bottom","left"].some(function(m){return u.indexOf(m)>=0})&&console.warn(["Popper: Detected CSS transitions on at least one of the following",'CSS properties: "transform", "top", "right", "bottom", "left".',`

`,'Disable the "computeStyles" modifier\'s `adaptive` option to allow',"for smooth transitions, or remove these properties from the CSS","transition declaration on the popper element if only transitioning","opacity or background-color for example.",`

`,"We recommend using the popper element as a wrapper around an inner","element that can have any CSS property transitioned for animations."].join(" "))}var i={placement:oe(e.placement),variation:Le(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:n,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,Ee(Object.assign({},i,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:l,roundOffsets:s})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,Ee(Object.assign({},i,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:s})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}var ta={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:ea,data:{}};function aa(t){var e=t.state;Object.keys(e.elements).forEach(function(a){var r=e.styles[a]||{},n=e.attributes[a]||{},o=e.elements[a];!I(o)||!L(o)||(Object.assign(o.style,r),Object.keys(n).forEach(function(l){var c=n[l];c===!1?o.removeAttribute(l):o.setAttribute(l,c===!0?"":c)}))})}function ra(t){var e=t.state,a={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,a.popper),e.styles=a,e.elements.arrow&&Object.assign(e.elements.arrow.style,a.arrow),function(){Object.keys(e.elements).forEach(function(r){var n=e.elements[r],o=e.attributes[r]||{},l=Object.keys(e.styles.hasOwnProperty(r)?e.styles[r]:a[r]),c=l.reduce(function(s,u){return s[u]="",s},{});!I(n)||!L(n)||(Object.assign(n.style,c),Object.keys(o).forEach(function(s){n.removeAttribute(s)}))})}}var na={name:"applyStyles",enabled:!0,phase:"write",fn:aa,effect:ra,requires:["computeStyles"]},oa=[Gt,Kt,ta,na],sa=Xt({defaultModifiers:oa});function ia(t,e,a){var r=oe(t),n=[U,W].indexOf(r)>=0?-1:1,o=typeof a=="function"?a(Object.assign({},e,{placement:t})):a,l=o[0],c=o[1];return l=l||0,c=(c||0)*n,[U,Y].indexOf(r)>=0?{x:c,y:l}:{x:l,y:c}}function la(t){var e=t.state,a=t.options,r=t.name,n=a.offset,o=n===void 0?[0,0]:n,l=Pt.reduce(function(i,m){return i[m]=ia(m,e.rects,o),i},{}),c=l[e.placement],s=c.x,u=c.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=s,e.modifiersData.popperOffsets.y+=u),e.modifiersData[r]=l}var ca={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:la};const[ua,z]=Ne("popover"),fa=["overlay","duration","teleport","overlayStyle","overlayClass","closeOnClickOverlay"],pa={show:Boolean,theme:G("light"),overlay:Boolean,actions:He(),actionsDirection:G("vertical"),trigger:G("click"),duration:Fe,showArrow:J,placement:G("bottom"),iconPrefix:String,overlayClass:Xe,overlayStyle:Object,closeOnClickAction:J,closeOnClickOverlay:J,closeOnClickOutside:J,offset:{type:Array,default:()=>[0,8]},teleport:{type:[String,Object],default:"body"}};var da=re({name:ua,props:pa,emits:["select","touchstart","update:show"],setup(t,{emit:e,slots:a,attrs:r}){let n;const o=R(),l=R(),c=R(),s=ht(()=>t.show,p=>e("update:show",p)),u=()=>({placement:t.placement,modifiers:[{name:"computeStyles",options:{adaptive:!1,gpuAcceleration:!1}},Je({},ca,{options:{offset:t.offset}})]}),i=()=>l.value&&c.value?sa(l.value,c.value.popupRef.value,u()):null,m=()=>{Ye(()=>{s.value&&(n?n.setOptions(u()):(n=i(),he&&(window.addEventListener("animationend",m),window.addEventListener("transitionend",m))))})},E=p=>{s.value=p},v=()=>{t.trigger==="click"&&(s.value=!s.value)},D=(p,w)=>{p.disabled||(e("select",p,w),t.closeOnClickAction&&(s.value=!1))},b=()=>{s.value&&t.closeOnClickOutside&&(!t.overlay||t.closeOnClickOverlay)&&(s.value=!1)},g=(p,w)=>a.action?a.action({action:p,index:w}):[p.icon&&O(Pe,{name:p.icon,classPrefix:t.iconPrefix,class:z("action-icon")},null),O("div",{class:[z("action-text"),{[Ke]:t.actionsDirection==="vertical"}]},[p.text])],k=(p,w)=>{const{icon:x,color:y,disabled:f,className:d}=p;return O("div",{role:"menuitem",class:[z("action",{disabled:f,"with-icon":x}),{[Ge]:t.actionsDirection==="horizontal"},d],style:{color:y},tabindex:f?void 0:0,"aria-disabled":f||void 0,onClick:()=>D(p,w)},[g(p,w)])};return ke(()=>{m(),Be(()=>{var p;o.value=(p=c.value)==null?void 0:p.popupRef.value})}),Ve(()=>{n&&(he&&(window.removeEventListener("animationend",m),window.removeEventListener("transitionend",m)),n.destroy(),n=null)}),ce(()=>[s.value,t.offset,t.placement],m),qe([l,o],b,{eventName:"touchstart"}),()=>{var p;return O(Z,null,[O("span",{ref:l,class:z("wrapper"),onClick:v},[(p=a.reference)==null?void 0:p.call(a)]),O(ze,Ue({ref:c,show:s.value,class:z([t.theme]),position:"",transition:"van-popover-zoom",lockScroll:!1,"onUpdate:show":E},r,We(),$e(t,fa)),{default:()=>[t.showArrow&&O("div",{class:z("arrow")},null),O("div",{role:"menu",class:z("content",t.actionsDirection)},[a.default?a.default():t.actions.map(k)])]})])}}});const va=Qe(da),ma={class:"flex flex-col mb-2"},ha={class:"mx-auto my-1 text-xs"},ga={class:"flex flex-col justify-end"},wa=re({__name:"MessageCard",props:{user_id:{},name:{},avatar:{},content:{},createTime:{},isSend:{type:Boolean},isShowName:{type:Boolean}},setup(t){const{user_id:e,name:a,avatar:r,content:n,isSend:o,isShowName:l}=t,c=$(()=>({"send-message":o})),s=$(()=>({"msg-pop-left":!o,"msg-pop":o}));return(u,i)=>{const m=ut;return M(),T("div",ma,[C("span",ha,X(u.createTime),1),C("div",{class:se(["flex",c.value])},[O(m,{class:"w-10 h-10 aspect-square rounded-md mx-1",fit:"cover",src:u.avatar,onClick:i[0]||(i[0]=E=>u.$router.push("/user/"+u.user_id))},null,8,["src"]),C("div",ga,[u.isShowName?Re("",!0):(M(),T("div",{key:0,class:se(["text-xs font-bold",{"text-right":u.isSend}])},X(u.name||""),3)),C("div",{class:se(["max-w-60 text-xs text-gray-500 p-2",s.value])},X(u.content),3)])],2)])}}}),ya=Ze(wa,[["__scopeId","data-v-85ba8def"]]),le=[["😊","😚","😘","😶","😏","😭","😳","😶"],["😴","😭","😳","😠","😜","😬","😲","😢"],["😎","😓","😖","😷","😆","😍","🙄","😒"],["😫","😪","😱","😓","😃","👮","💪","😡"],["❓","🤫","😵","😩","😞","💀","👊","👋"],["😅","👃","👏","😳","😈","😒","😒","😫"],["😑","😢","😢","😏","😱","😨","😢","🔪"],["🍉","🍺","🏀","🏓","☕","🍛","🐷","🌹"],["💔","💑","❤️","💔","🎂","⚡","💣","🔪"],["⚽","🐞","💩","🌜","🌞","🎁","🤗","💪"],["👎","👍","✊","👊","😏","✊","👎","💖"],["🚫","👌","💞","💋","🦘","💥","😠","🔄"],["🙇","🔙","🤸","👋","🤩","🕺","⬅️","➡️"]],ba={class:"w-full p-2 max-h-80"},xa=["data-row","data-col"],Oa=re({__name:"EmojiBoard",props:{modelValue:{},modelModifiers:{}},emits:et(["clickEmoji"],["update:modelValue"]),setup(t,{emit:e}){const a=tt(t,"modelValue"),r=e,n=o=>{const l=o.target;if(l.tagName==="SPAN"){const c=parseInt(l.dataset.row||"0"),s=parseInt(l.dataset.col||"0");r("clickEmoji",le[c][s]),a.value=le[c][s]}};return(o,l)=>(M(),T("div",ba,[C("ul",{onClick:n,class:"flex flex-col max-h-80 overflow-y-scroll"},[(M(!0),T(Z,null,ue(Ce(le),(c,s)=>(M(),T("li",{class:"flex justify-around my-1",key:s},[(M(!0),T(Z,null,ue(c,(u,i)=>(M(),T("span",{class:"w-8 h-8 text-center text-2xl cursor-pointer",key:i,"data-row":s,"data-col":i},X(u),9,xa))),128))]))),128))])]))}}),_a={class:"bg-white flex flex-col"},Sa={class:"fixed bottom-0 w-full p-2 flex items-center border-t-blue-100 bg-white"},Ea={class:"flex mx-2"},ka={class:"relative flex"},ja=re({__name:"ChatPage",setup(t){ke(()=>{E()});const e=ot(),a=lt(),r=ft(),n=at(),o=$(()=>r.getContactedUserMap(Number(e.params.id))),l=$(()=>{var f,d,_;return{user_id:(f=n.userInfo)==null?void 0:f.user_id,nickname:(d=n.userInfo)==null?void 0:d.nickname,avatar_url:(_=n.userInfo)==null?void 0:_.avatar_url}}),c=$(()=>{var f;return!!((f=e.meta)!=null&&f.title)}),s=$(()=>{var f;return!((f=e.meta)!=null&&f.hideNavbar)}),u=R({currentPage:1,pageSize:10,total:-1}),i=R([]),m=f=>f===l.value.user_id,E=async()=>{if(u.value.total!==-1&&(u.value.currentPage-1)*u.value.pageSize>=u.value.total){ie("没有更多消息了"),console.log(u.value.total,u.value.currentPage*u.value.pageSize);return}const f={user2_id:Number(e.params.id),user1_id:l.value.user_id,page:u.value.currentPage,limit:u.value.pageSize};try{const d=await pt(f);i.value.unshift(...d.data.list.map(_=>{const P=m(_.sender_id),A=P?{user_id:l.value.user_id,nickname:l.value.nickname,avatar_url:l.value.avatar_url}:o.value;return{..._,isSender:P,user_info:A}}).reverse()),u.value.total=d.data.totalCount,u.value.currentPage=d.data.currentPage,u.value.pageSize=d.data.pageSize}catch(d){console.error(d)}},v=R(""),D=R(""),b=R(!1),g=R(0),k=f=>{g.value=f.target.selectionStart},p=f=>{v.value=v.value.slice(0,g.value)+f+v.value.slice(g.value),g.value=g.value+f.length},w=async()=>{if(!v.value){ie("请输入内容");return}const f={sender_type:ye.USER,sender_id:l.value.user_id,receiver_id:Number(e.params.id),receiver_type:ye.USER,content:v.value,type:dt.PRIVATE_MESSAGE};await vt(f);const d={user_id:l.value.user_id,nickname:l.value.nickname,avatar_url:l.value.avatar_url},P={content:v.value,sender_id:d.user_id,receiver_id:Number(e.params.id),created_at:new Date().toISOString(),id:new Date().getTime(),isSender:!0,user_info:d};i.value.push(P),v.value=""},x=R(!1),y=async()=>{console.log("下拉刷新"),u.value.currentPage++,await E(),ie("刷新成功"),x.value=!1};return(f,d)=>{const _=st,P=it,A=mt,S=Pe,B=va;return M(),T("main",_a,[s.value?(M(),ge(_,{key:0,fixed:"","z-index":999,"left-text":"返回","left-arrow":"",onClickLeft:d[0]||(d[0]=h=>Ce(a).back())},{title:F(()=>{var h;return[C("span",null,X(c.value?(h=o.value)==null?void 0:h.nickname:""),1)]}),_:1})):Re("",!0),O(we,{height:"50px"}),O(P,{class:"flex-1",modelValue:x.value,"onUpdate:modelValue":d[1]||(d[1]=h=>x.value=h),onRefresh:y},{default:F(()=>[C("div",null,[(M(!0),T(Z,null,ue(i.value,h=>(M(),ge(ya,{key:h.id,user_id:h.user_info.user_id,"is-send":h.isSender,content:h.content,name:h.user_info.nickname,avatar:h.user_info.avatar_url,createTime:h.created_at},null,8,["user_id","is-send","content","name","avatar","createTime"]))),128))])]),_:1},8,["modelValue"]),O(we,{height:"50px"}),C("div",Sa,[C("div",Ea,[rt(C("input",{onBlur:k,"onUpdate:modelValue":d[2]||(d[2]=h=>v.value=h),class:"border border-blue-200 rounded-md mx-2 px-1",type:"text"},null,544),[[nt,v.value]]),O(A,{type:"primary",size:"small",onClick:w},{default:F(()=>[ct("发送")]),_:1})]),C("div",ka,[O(B,{placement:"top-end","z-index":"999",show:b.value,"onUpdate:show":d[4]||(d[4]=h=>b.value=h)},{reference:F(()=>[O(S,{class:"mx-2",name:"smile-o",size:"30"})]),default:F(()=>[O(Oa,{modelValue:D.value,"onUpdate:modelValue":d[3]||(d[3]=h=>D.value=h),onClickEmoji:p},null,8,["modelValue"])]),_:1},8,["show"]),O(S,{name:"add-o",size:"30"})])])])}}});export{ja as default};
