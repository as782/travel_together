import{O as H,a7 as m,a8 as R,a9 as I,aa as K,ab as U,ac as y,ad as L,d as z,r as M,J as W,ae as j,b as o,af as S,ag as p,ah as q,ai as J,aj as k,ak as V,al as G,am as Q,an as X,ao as Y,ap as Z,aq as $,a1 as ee}from"./index-Al1ESLyH.js";import{B as P}from"./index-dW7UAVpM.js";import{A as te}from"./index-DEValKwa.js";import{A as T}from"./index-BVAKaSy2.js";const[ne,l,f]=H("dialog"),oe=m({},R,{title:String,theme:String,width:I,message:[String,Function],callback:Function,allowHtml:Boolean,className:K,transition:U("van-dialog-bounce"),messageAlign:String,closeOnPopstate:y,showCancelButton:Boolean,cancelButtonText:String,cancelButtonColor:String,cancelButtonDisabled:Boolean,confirmButtonText:String,confirmButtonColor:String,confirmButtonDisabled:Boolean,showConfirmButton:y,closeOnClickOverlay:Boolean}),ae=[...L,"transition","closeOnPopstate"];var x=z({name:ne,props:oe,emits:["confirm","cancel","keydown","update:show"],setup(e,{emit:r,slots:a}){const u=M(),i=W({confirm:!1,cancel:!1}),C=t=>r("update:show",t),b=t=>{var n;C(!1),(n=e.callback)==null||n.call(e,t)},v=t=>()=>{e.show&&(r(t),e.beforeClose?(i[t]=!0,X(e.beforeClose,{args:[t],done(){b(t),i[t]=!1},canceled(){i[t]=!1}})):b(t))},B=v("cancel"),g=v("confirm"),O=j(t=>{var n,s;if(t.target!==((s=(n=u.value)==null?void 0:n.popupRef)==null?void 0:s.value))return;({Enter:e.showConfirmButton?g:k,Escape:e.showCancelButton?B:k})[t.key](),r("keydown",t)},["enter","esc"]),D=()=>{const t=a.title?a.title():e.title;if(t)return o("div",{class:l("header",{isolated:!e.message&&!a.default})},[t])},A=t=>{const{message:n,allowHtml:s,messageAlign:c}=e,d=l("message",{"has-title":t,[c]:c}),h=V(n)?n():n;return s&&typeof h=="string"?o("div",{class:d,innerHTML:h},null):o("div",{class:d},[h])},E=()=>{if(a.default)return o("div",{class:l("content")},[a.default()]);const{title:t,message:n,allowHtml:s}=e;if(n){const c=!!(t||a.title);return o("div",{key:s?1:0,class:l("content",{isolated:!c})},[A(c)])}},N=()=>o("div",{class:[Q,l("footer")]},[e.showCancelButton&&o(P,{size:"large",text:e.cancelButtonText||f("cancel"),class:l("cancel"),style:{color:e.cancelButtonColor},loading:i.cancel,disabled:e.cancelButtonDisabled,onClick:B},null),e.showConfirmButton&&o(P,{size:"large",text:e.confirmButtonText||f("confirm"),class:[l("confirm"),{[G]:e.showCancelButton}],style:{color:e.confirmButtonColor},loading:i.confirm,disabled:e.confirmButtonDisabled,onClick:g},null)]),_=()=>o(te,{class:l("footer")},{default:()=>[e.showCancelButton&&o(T,{type:"warning",text:e.cancelButtonText||f("cancel"),class:l("cancel"),color:e.cancelButtonColor,loading:i.cancel,disabled:e.cancelButtonDisabled,onClick:B},null),e.showConfirmButton&&o(T,{type:"danger",text:e.confirmButtonText||f("confirm"),class:l("confirm"),color:e.confirmButtonColor,loading:i.confirm,disabled:e.confirmButtonDisabled,onClick:g},null)]}),F=()=>a.footer?a.footer():e.theme==="round-button"?_():N();return()=>{const{width:t,title:n,theme:s,message:c,className:d}=e;return o(J,S({ref:u,role:"dialog",class:[l([s]),d],style:{width:q(t)},tabindex:0,"aria-labelledby":n||c,onKeydown:O,"onUpdate:show":C},p(e,ae)),{default:()=>[D(),E(),F()]})}}});let w;const le={title:"",width:"",theme:null,message:"",overlay:!0,callback:null,teleport:"body",className:"",allowHtml:!1,lockScroll:!0,transition:void 0,beforeClose:null,overlayClass:"",overlayStyle:void 0,messageAlign:"",cancelButtonText:"",cancelButtonColor:null,cancelButtonDisabled:!1,confirmButtonText:"",confirmButtonColor:null,confirmButtonDisabled:!1,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!0,closeOnClickOverlay:!1};let se=m({},le);function ce(){({instance:w}=Z({setup(){const{state:r,toggle:a}=$();return()=>o(x,S(r,{"onUpdate:show":a}),null)}}))}function re(e){return Y?new Promise((r,a)=>{w||ce(),w.open(m({},se,e,{callback:u=>{(u==="confirm"?r:a)(u)}}))}):Promise.resolve(void 0)}const me=e=>re(m({showCancelButton:!0},e));ee(x);export{me as a,re as s};
